<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, width=device-width" />
    <link rel="stylesheet" type="text/css" href="https://js.cit.api.here.com/v3/3.0/mapsjs-ui.css" />
    <script type="text/javascript" src="https://js.cit.api.here.com/v3/3.0/mapsjs-core.js"></script>
    <script type="text/javascript" src="https://js.cit.api.here.com/v3/3.0/mapsjs-service.js"></script>
    <script type="text/javascript" src="https://js.cit.api.here.com/v3/3.0/mapsjs-ui.js"></script>
    <script type="text/javascript" src="https://js.cit.api.here.com/v3/3.0/mapsjs-mapevents.js"></script>
<<<<<<< HEAD
    
    <!-- JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- Custom script -->
    <script type="text/javascript" src="js/websocket.js"></script>
    <script type="text/javascript" src="js/bubble.js"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" type="text/css" href="css/style.css"/> 
</head>
<body>
    <div id="map" style="position: absolute; width: 100%; height: 100%; background: grey" />
    
    <script  type="text/javascript" charset="UTF-8" >
        
    /***** variables *****/
        
    // mock json vehicle data
    var mock_veh_info = '{"veh_plate_no":"WTM 9831","driver":"Ikram Jalil","location":"3.212577, 101.711157","time":"16/04/2018 17:34:45","current_speed":"89km/h","average_speed":"78km/h","today_top_speed":"103km/h","driving_behavior":"Good"}';

    // convert mock_veh_info(string) to object
    var veh_info = JSON.parse(mock_veh_info);
        
    // initial position
    var position = [3.069609,101.503761];
        
    /**
     * Boilerplate map initialization code starts below:
     */ 

=======

    <!-- Custom script -->
    <script type="text/javascript" src="js/websocket.js"></script>
    <!-- Custom CSS -->
    <link type="text/css" href="style.css"/> 
</head>
<body>
    <div id="map" style="position: absolute; width: 100%; height: 100%; background: grey" />
    <script  type="text/javascript" charset="UTF-8" >
    
    /**
    * Creates a new marker and adds it to a group
    * @param {H.map.Group} group       The group holding the new marker
    * @param {H.geo.Point} coordinate  The location of the marker
    * @param {String} html             Data associated with the marker
    */        
    function addMarkerToGroup(group, coordinate, html) {
        var marker = new H.map.Marker(coordinate);
        // add custom data to the marker
        marker.setData(html);
        group.addObject(marker);
    }

    /**
     * Add two markers showing the position of Liverpool and Manchester City football clubs.
     * Clicking on a marker opens an infobubble which holds HTML content related to the marker.
     * @param  {H.Map} map      A HERE Map instance within the application
     */
    function addInfoBubble(map) {
        var group = new H.map.Group();

        map.addObject(group);

        // add 'tap' event listener, that opens info bubble, to the group
        group.addEventListener('tap', function (evt) {
        // event target is the marker itself, group is a parent event target
        // for all objects that it contains
            var bubble =  new H.ui.InfoBubble(evt.target.getPosition(), {
                // read custom data
                content: evt.target.getData()
            });
            // show info bubble
            bubble.getElement().addClass("ib-body");
            ui.addBubble(bubble);
        }, false);

        addMarkerToGroup(group, {lat:position[0], lng:position[1]},
            '<div><a href=\'http://www.mcfc.co.uk\' >Manchester City</a>' +
            '</div><div >City of Manchester Stadium<br>Capacity: 48,000</div>');

        addMarkerToGroup(group, {lat:3.248, lng:101.428},
            '<div class="ib-body"><a href=\'http://www.liverpoolfc.tv\' >Liverpool</a>' +
            '</div><div >Anfield<br>Capacity: 45,362</div>');
    }

    // initial position
    var position = [3.069609,101.503761];

    /**
     * Boilerplate map initialization code starts below:
     */

>>>>>>> c856e7576ff3799232d2701227a8e8ada19b41be
    // initialize communication with the platform
    var platform = new H.service.Platform({
        app_id: 'DemoAppId01082013GAL',
        app_code: 'AJKnXv84fjrb0KIHawS0Tg',
        useCIT: true,
        useHTTPS: true
    });
    var defaultLayers = platform.createDefaultLayers();

    // initialize a map - this map is centered over Europe
    var map = new H.Map(document.getElementById('map'),
        defaultLayers.normal.map,{
        center: {lat: position[0], lng: position[1]},
        zoom: 10
    });
<<<<<<< HEAD

    // MapEvents enables the event system
    // Behavior implements default interactions for pan/zoom (also on mobile touch environments)
    var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));
=======

    // MapEvents enables the event system
    // Behavior implements default interactions for pan/zoom (also on mobile touch environments)
    var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));

    // create default UI with layers provided by the platform
    var ui = H.ui.UI.createDefault(map, defaultLayers);

    // Now use the map as required...
    addInfoBubble(map);
>>>>>>> c856e7576ff3799232d2701227a8e8ada19b41be

    // create default UI with layers provided by the platform
    var ui = H.ui.UI.createDefault(map, defaultLayers);
        
    
    // Now use the map as required...
    addInfoBubble(map);        
        
    </script>
    
    <div id="ib" class="info_box round2" onclick="closeInfoBox()">
        <div class="profile_picture" style="width=25%; float: left;">
            <img style="display: inline-block" src="resources/profile.png" height="32" width="32">
        </div>
        <div class="header" style="width=75%; float: left;">
            <h3 style="text-align: center; margin: 10px"><script>document.write(veh_info.veh_plate_no)</script> </h3>
        </div>  
        <table> 
            <tr><td>No plate </td><td>: <script>document.write(veh_info.veh_plate_no)</script> </td></tr>
            <tr><td>Driver </td><td>: <script>document.write(veh_info.driver)</script> </td></tr>
            <tr><td>Location </td><td>: <script>document.write(veh_info.location)</script> </td></tr>
            <tr><td>Time </td><td>: <script>document.write(veh_info.time)</script> </td></tr>
            <tr><td>Current speed </td><td>: <script>document.write(veh_info.current_speed)</script> </td></tr>
            <tr><td>Average speed </td><td>: <script>document.write(veh_info.average_speed)</script> </td></tr>
            <tr><td>Today top speed </td><td>: <script>document.write(veh_info.today_top_speed)</script> </td></tr>
            <tr><td>Driving behavior </td><td>: <script>document.write(veh_info.driving_behavior)</script> </td></tr>
        </table>
    </div>
    
    <script>
        /***** Functions *****/
        
        // open info box
        function openInfoBox() {
            document.getElementById("ib").style.display = "block";
        }
        // close info box
        function closeInfoBox() {
            document.getElementById("ib").style.display = "none";
        }
    </script>
</body>
</html>
